<!-- <div class="form-container">
  <mat-card class="form-card">
    <mat-card-title class="mb-3">
      <h1 class="title">
        <mat-icon matListItemIcon>article</mat-icon>
        {{ fileId ? "Editar Archivo" : "Nuevo Archivo" }}
      </h1>
    </mat-card-title>
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Nombre del archivo</mat-label>
            <input matInput formControlName="fileName" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Tipo de archivo</mat-label>
            <mat-select formControlName="fileType">
              <mat-option value="RECEIPT">Recibo</mat-option>
              <mat-option value="BILLING">Factura</mat-option>
              <mat-option value="PAYMENT">Pago</mat-option>
              <mat-option value="OTHER">Otro</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Tipo de contenido</mat-label>
            <mat-select formControlName="fileContentType">
              <mat-option value="application/pdf">PDF</mat-option>
              <mat-option value="image/png">Imagen PNG</mat-option>
              <mat-option value="image/jpeg">Imagen JPEG</mat-option>
              <mat-option value="image/jpg">Imagen JPG</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nota de revisión</mat-label>
            <textarea matInput formControlName="reviewNote"></textarea>
          </mat-form-field>

          <div class="full-width">
            <mat-radio-group formControlName="targetType" class="d-flex gap-3">
              @for (type of entityTypes; track type.value) {
              <mat-radio-button [value]="type.value">{{
                type.label
              }}</mat-radio-button>
              }
            </mat-radio-group>
          </div>

          @if (targetType === 'CLIENT') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Cliente Asociado</mat-label>
            <mat-select formControlName="clientId">
              @for (client of clients; track client.idClient) {
              <mat-option [value]="client.idClient">
                {{ client.firstName }} {{ client.lastName }}
              </mat-option>
              }
            </mat-select>
          </mat-form-field>
          }

          @if (targetType === 'SUPPLIER') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Proveedor Asociado</mat-label>
            <mat-select formControlName="supplierId">
              @for (supplier of suppliers; track supplier.idSupplier) {
              <mat-option [value]="supplier.idSupplier">
                {{ supplier.name }}
              </mat-option>
              }
            </mat-select>
          </mat-form-field>
          }

          @if (targetType === 'EMPLOYEE') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Empleado Asociado</mat-label>
            <mat-select formControlName="employeeId">
              @for (employee of employees; track employee.idEmployee) {
              <mat-option [value]="employee.idEmployee">
                {{ employee.firstName }} {{ employee.lastName }}
              </mat-option>
              }
            </mat-select>
          </mat-form-field>
          }

          <div class="d-flex gap-4 align-items-start full-width">
            <div class="file-input-container" style="flex: 1;">
              <mat-label>Seleccionar archivo</mat-label>
              <input
                formControlName="file"
                type="file"
                (change)="onFileSelected($event)"
                accept=".png, .pdf, .jpg, .jpeg, .csv"
                class="file-input"
              />
            </div>
          
            @if (previewUrl) {
              <iframe
                [src]="previewUrl"
                style="width: 200px; height: 100px; border: 1px solid #ccc;"
                title="Vista previa"
              ></iframe>
            }
          </div>
          
        </div>

        <div class="action-buttons">
          <button mat-stroked-button type="button" (click)="goBack()">
            Volver
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="form.invalid"
          >
            {{ fileId ? "Guardar cambios" : "Subir Archivo" }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
 -->
 <div class="form-container">
  <mat-card class="form-card">
    <mat-card-title class="mb-3">
      <div class="card-header pe-3">
        <h1 class="title">
          <mat-icon matListItemIcon>article</mat-icon>
          {{ fileId ? "Editar Archivo" : "Nuevo Archivo" }}
        </h1>
        <div class="image-container-pet">
          <img src="assets/pet.png" alt="ERP Eventos" />
        </div>
      </div>
    </mat-card-title>
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Nombre del archivo</mat-label>
            <input matInput formControlName="fileName" />
            <mat-error>
              <app-form-field-error [control]="form.get('fileName')"></app-form-field-error>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Tipo de archivo</mat-label>
            <mat-select formControlName="fileType">
              <mat-option value="RECEIPT">Recibo</mat-option>
              <mat-option value="BILLING">Factura</mat-option>
              <mat-option value="PAYMENT">Pago</mat-option>
              <mat-option value="OTHER">Otro</mat-option>
            </mat-select>
            <mat-error>
              <app-form-field-error [control]="form.get('fileType')"></app-form-field-error>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Tipo de contenido</mat-label>
            <mat-select formControlName="fileContentType">
              <mat-option value="application/pdf">PDF</mat-option>
              <mat-option value="image/png">Imagen PNG</mat-option>
              <mat-option value="image/jpeg">Imagen JPEG</mat-option>
              <mat-option value="image/jpg">Imagen JPG</mat-option>
            </mat-select>
            <mat-error>
              <app-form-field-error [control]="form.get('fileContentType')"></app-form-field-error>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nota de revisión</mat-label>
            <textarea matInput formControlName="reviewNote"></textarea>
            <mat-error>
              <app-form-field-error [control]="form.get('reviewNote')"></app-form-field-error>
            </mat-error>
          </mat-form-field>

          <div class="full-width">
            <mat-radio-group formControlName="targetType" class="d-flex gap-3">
              @for (type of entityTypes; track type.value) {
                <mat-radio-button [value]="type.value">{{ type.label }}</mat-radio-button>
              }
            </mat-radio-group>
            <mat-error>
              <app-form-field-error [control]="form.get('targetType')"></app-form-field-error>
            </mat-error>
          </div>

          @if (targetType === 'CLIENT') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Cliente Asociado</mat-label>
            <mat-select formControlName="clientId">
              @for (client of clients; track client.idClient) {
                <mat-option [value]="client.idClient">
                  {{ client.firstName }} {{ client.lastName }}
                </mat-option>
              }
            </mat-select>
            <mat-error>
              <app-form-field-error [control]="form.get('clientId')"></app-form-field-error>
            </mat-error>
          </mat-form-field>
          }

          @if (targetType === 'SUPPLIER') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Proveedor Asociado</mat-label>
            <mat-select formControlName="supplierId">
              @for (supplier of suppliers; track supplier.idSupplier) {
                <mat-option [value]="supplier.idSupplier">
                  {{ supplier.name }}
                </mat-option>
              }
            </mat-select>
            <mat-error>
              <app-form-field-error [control]="form.get('supplierId')"></app-form-field-error>
            </mat-error>
          </mat-form-field>
          }

          @if (targetType === 'EMPLOYEE') {
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Empleado Asociado</mat-label>
            <mat-select formControlName="employeeId">
              @for (employee of employees; track employee.idEmployee) {
                <mat-option [value]="employee.idEmployee">
                  {{ employee.firstName }} {{ employee.lastName }}
                </mat-option>
              }
            </mat-select>
            <mat-error>
              <app-form-field-error [control]="form.get('employeeId')"></app-form-field-error>
            </mat-error>
          </mat-form-field>
          }

          <div class="d-flex gap-4 align-items-start full-width">
            <div class="file-input-container" style="flex: 1;">
              <mat-label>Seleccionar archivo</mat-label>
              <input
                formControlName="file"
                type="file"
                (change)="onFileSelected($event)"
                accept=".png, .pdf, .jpg, .jpeg, .csv"
                class="file-input"
              />
              <mat-error>
                <app-form-field-error [control]="form.get('file')"></app-form-field-error>
              </mat-error>
            </div>

            @if (previewUrl) {
            <iframe
              [src]="previewUrl"
              style="width: 200px; height: 100px; border: 1px solid #ccc;"
              title="Vista previa"
            ></iframe>
            }
          </div>
        </div>

        <div class="action-buttons">
          <button mat-stroked-button type="button" (click)="goBack()">
            Volver
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="form.invalid"
          >
            {{ fileId ? "Guardar cambios" : "Subir Archivo" }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
